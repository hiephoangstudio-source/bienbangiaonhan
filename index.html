<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£n Giao Nh·∫≠n V·∫≠t T∆∞</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Times+New+Roman:ital,wght@0,400;0,700;1,400;1,700&display=swap');
        
        * { box-sizing: border-box; }

        body { 
            font-family: 'Times New Roman', serif; 
            font-size: 10pt; 
            line-height: 1.25; 
            color: #000; 
            background-color: #f0f2f5; 
            margin: 0; padding: 0; 
        }

        @page { size: A4 portrait; margin: 0; }

        .actions-container { 
            position: sticky; top: 0; display: flex; justify-content: center; gap: 15px;
            width: 100%; background-color: #343a40; padding: 10px; z-index: 2000; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .action-btn { background-color: #0d6efd; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }

        .page-wrapper { display: flex; justify-content: center; padding: 20px; }

        .a4-page {
            width: 210mm;
            min-height: 296mm; 
            background: white;
            padding: 10mm 15mm; 
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
        }

        /* HEADER */
        .header-section { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .header-left { flex: 1; }
        .studio-name { font-weight: bold; font-size: 11pt; text-transform: uppercase; display: block; margin-bottom: 2px; }
        .studio-info { display: block; font-size: 10pt; margin-bottom: 1px; }
        
        .header-right { text-align: left; min-width: 140px; }
        .voucher-num-line { font-size: 10pt; margin-bottom: 2px; }

        /* TITLE */
        .title-section { text-align: center; margin-bottom: 15px; }
        .main-title { font-size: 18pt; font-weight: bold; text-transform: uppercase; margin: 0; }
        .date-sub { font-style: italic; font-size: 10pt; margin-top: 5px; }

        /* INFO FORM */
        .info-section { margin-bottom: 15px; }
        .form-row { display: flex; align-items: baseline; margin-bottom: 8px; } /* TƒÉng kho·∫£ng c√°ch d√≤ng vi·∫øt tay */
        .label { white-space: nowrap; margin-right: 5px; font-size: 11pt; }
        .value { flex: 1; border-bottom: 1px dotted #000; font-weight: bold; padding-left: 5px; font-size: 11pt; min-height: 18px; }

        /* TABLE */
        table.handover-table { width: 100%; border-collapse: collapse; font-size: 10pt; margin-bottom: 15px; }
        table.handover-table th { border: 1px solid #000; padding: 5px 2px; background: #fff; font-weight: bold; height: 40px; vertical-align: middle; text-align: center;}
        table.handover-table td { border: 1px solid #000; padding: 4px; height: 28px; vertical-align: middle; } /* TƒÉng chi·ªÅu cao d√≤ng ƒë·ªÉ vi·∫øt */
        
        .center { text-align: center; }
        .right { text-align: right; }
        .bold { font-weight: bold; }

        /* SIGNATURE BLOCKS */
        .signature-block-wrapper { margin-top: 10px; }
        .sig-section { margin-bottom: 20px; }
        .sig-header-row { display: flex; justify-content: space-between; margin-bottom: 5px; }
        .sig-section-title { font-weight: bold; text-decoration: underline; font-size: 11pt;}
        .sig-date-line { font-style: italic; font-size: 10pt; }

        .sig-grid { display: flex; justify-content: space-between; text-align: center; }
        .sig-col { width: 19%; } 
        .sig-role { font-weight: bold; font-size: 10pt; margin-bottom: 2px; }
        .sig-note { font-style: italic; font-size: 9pt; margin-bottom: 45px; } 
        
        @media print {
            body { background: none; }
            .actions-container { display: none; }
            .page-wrapper { padding: 0; }
            .a4-page { width: 100%; height: 296mm; box-shadow: none; } 
        }
    </style>
</head>
<body>

    <div class="actions-container">
        <button onclick="window.print()" class="action-btn">üñ®Ô∏è In Phi·∫øu</button>
        <button onclick="downloadPDF()" class="action-btn" style="margin-left:10px">üìÑ T·∫£i PDF</button>
    </div>

    <div class="page-wrapper">
        <div class="a4-page" id="print-area">
            
            <!-- HEADER -->
            <div class="header-section">
                <div class="header-left">
                    <span class="studio-name" id="ten-studio">2H STUDIO</span>
                    <span class="studio-info">ƒêC: <span id="dc-studio"></span></span>
                    <span class="studio-info">Email: <span id="email-studio"></span></span> <!-- Th√™m Email -->
                    <span class="studio-info">Hotline: <span id="hl-studio"></span></span>
                </div>
                <div class="header-right">
                    <div class="voucher-num-line">Quy·ªÉn s·ªë: ...........</div>
                    <div class="voucher-num-line">S·ªë: <span class="bold" id="so-phieu">..........</span></div>
                </div>
            </div>

            <!-- TITLE -->
            <div class="title-section">
                <h1 class="main-title">B·∫¢N GIAO NH·∫¨N V·∫¨T T∆Ø</h1>
                <div class="date-sub" id="ngay-thang">Ng√†y ... th√°ng ... nƒÉm ...</div>
            </div>

            <!-- INFO (ƒê·ªÇ TR·ªêNG T·ª∞ GHI) -->
            <div class="info-section">
                <div class="form-row">
                    <span class="label">H·ªç v√† t√™n ng∆∞·ªùi nh·∫≠n h√†ng:</span>
                    <span class="value"></span> <!-- Tr·ªëng -->
                </div>
                <div class="form-row">
                    <span class="label">ƒê·ªãa ch·ªâ (B·ªô ph·∫≠n):</span>
                    <span class="value"></span> <!-- Tr·ªëng -->
                </div>
                <div class="form-row">
                    <span class="label">L√Ω do xu·∫•t h√†ng:</span>
                    <span class="value"></span> <!-- Tr·ªëng -->
                </div>
                <div class="form-row">
                    <span class="label" style="width: 50%;">Xu·∫•t t·∫°i kho: <span class="value" style="border:none; border-bottom:1px dotted #000" id="kho-nhap"></span></span>
                    <span class="label" style="width: 50%;">ƒê·ªãa ƒëi·ªÉm: <span class="value" style="border:none; border-bottom:1px dotted #000" id="dia-diem"></span></span>
                </div>
            </div>

            <!-- TABLE (B·ªé C·ªòT M√É, ƒêVT - ƒê·ªÇ TR·ªêNG) -->
            <table class="handover-table">
                <thead>
                    <tr>
                        <th style="width: 40px;">STT</th>
                        <th>T√™n v·∫≠t t∆∞, d·ª•ng c·ª•, s·∫£n ph·∫©m</th> <!-- C·ªôt n√†y t·ª± ƒë·ªông gi√£n r·ªông -->
                        <th style="width: 70px;">S·ªë l∆∞·ª£ng<br>xu·∫•t</th>
                        <th style="width: 90px;">ƒê∆°n gi√°</th>
                        <th style="width: 100px;">Th√†nh ti·ªÅn</th>
                        <th style="width: 70px;">S·ªë l∆∞·ª£ng<br>nh·∫≠n</th>
                        <th style="width: 100px;">Ghi ch√∫</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- Rows generated by JS -->
                </tbody>
            </table>

            <!-- SIGNATURES (3 SECTIONS) -->
            <div class="signature-block-wrapper">
                
                <!-- 1. Xu·∫•t h√†ng -->
                <div class="sig-section">
                    <div class="sig-header-row">
                        <span class="sig-section-title">1. Xu·∫•t h√†ng:</span>
                        <span class="sig-date-line">Xu·∫•t ng√†y‚Ä¶‚Ä¶ th√°ng ‚Ä¶‚Ä¶ nƒÉm ‚Ä¶..</span>
                    </div>
                    <div class="sig-grid">
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi l·∫≠p phi·∫øu</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi giao h√†ng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi nh·∫≠n h√†ng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">K·∫ø to√°n tr∆∞·ªüng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Th·ªß tr∆∞·ªüng ƒë∆°n v·ªã</div><div class="sig-note">(K√Ω, ƒë√≥ng d·∫•u)</div></div>
                    </div>
                </div>

                <!-- 2. Nh·∫≠p h√†ng -->
                <div class="sig-section">
                    <div class="sig-header-row">
                        <span class="sig-section-title">2. Nh·∫≠p h√†ng:</span>
                        <span class="sig-date-line">Nh·∫≠p ng√†y‚Ä¶‚Ä¶ th√°ng ‚Ä¶‚Ä¶ nƒÉm ‚Ä¶..</span>
                    </div>
                    <div class="sig-grid">
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi l·∫≠p phi·∫øu</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi giao h√†ng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi nh·∫≠n h√†ng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">K·∫ø to√°n tr∆∞·ªüng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Th·ªß tr∆∞·ªüng ƒë∆°n v·ªã</div><div class="sig-note">(K√Ω, ƒë√≥ng d·∫•u)</div></div>
                    </div>
                </div>

                <!-- 3. H√†ng m·∫•t h·ªèng -->
                <div class="sig-section">
                    <div class="sig-header-row">
                        <span class="sig-section-title">3. H√†ng m·∫•t h·ªèng:</span>
                        <span class="sig-date-line">K√Ω nh·∫≠n ng√†y‚Ä¶‚Ä¶ th√°ng ‚Ä¶‚Ä¶ nƒÉm ‚Ä¶..</span>
                    </div>
                    <div class="sig-grid">
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi l·∫≠p phi·∫øu</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi giao h√†ng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi nh·∫≠n h√†ng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">K·∫ø to√°n tr∆∞·ªüng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div></div>
                        <div class="sig-col"><div class="sig-role">Th·ªß tr∆∞·ªüng ƒë∆°n v·ªã</div><div class="sig-note">(K√Ω, ƒë√≥ng d·∫•u)</div></div>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);

        // D·ªØ li·ªáu m·∫´u (Ch·ªâ l·∫•y th√¥ng tin Header)
        const dbData = {
            id_phieu: params.get('id') || "..........",
            ngay_lap: params.get('ngay') || new Date().toISOString().split('T')[0],
            
            studio_ten: params.get('ten_studio') || "2H STUDIO",
            studio_dc: params.get('dia_chi_studio') || "",
            studio_email: params.get('email_studio') || "",
            studio_hl: params.get('hotline_studio') || "",
        };

        function renderApp() {
            // Fill th√¥ng tin Header
            document.getElementById('so-phieu').textContent = dbData.id_phieu;
            document.getElementById('ten-studio').textContent = dbData.studio_ten;
            document.getElementById('dc-studio').textContent = dbData.studio_dc;
            document.getElementById('email-studio').textContent = dbData.studio_email;
            document.getElementById('hl-studio').textContent = dbData.studio_hl;
            
            document.getElementById('kho-nhap').textContent = dbData.studio_ten; 
            document.getElementById('dia-diem').textContent = dbData.studio_dc;

            // Ng√†y th√°ng
            const d = new Date(dbData.ngay_lap);
            const dateStr = `Ng√†y ${d.getDate().toString().padStart(2,'0')} th√°ng ${(d.getMonth()+1).toString().padStart(2,'0')} nƒÉm ${d.getFullYear()}`;
            document.getElementById('ngay-thang').textContent = dateStr;

            // Render Table (Tr·ªëng ho√†n to√†n ƒë·ªÉ t·ª± ghi)
            const tbody = document.getElementById('table-body');
            let rowsHtml = '';
            
            // T·∫°o 15 d√≤ng tr·ªëng
            for (let i = 0; i < 15; i++) {
                rowsHtml += `
                    <tr>
                        <td class="center">${i+1}</td>
                        <td></td> <!-- T√™n v·∫≠t t∆∞ -->
                        <td></td> <!-- SL Xu·∫•t -->
                        <td></td> <!-- ƒê∆°n gi√° -->
                        <td></td> <!-- Th√†nh ti·ªÅn -->
                        <td></td> <!-- SL Nh·∫≠n -->
                        <td></td> <!-- Ghi ch√∫ -->
                    </tr>
                `;
            }
            tbody.innerHTML = rowsHtml;
            document.title = "GIAO_NHAN_" + dbData.id_phieu;
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderApp();
        });

        function downloadPDF() {
            const element = document.getElementById('print-area');
            const opt = { margin: 0, filename: document.title + '.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2 }, jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' } };
            html2pdf().from(element).set(opt).save();
        }
    </script>
</body>
</html>
